<template>
    <div class="page">
        <div class="navbar">
            <div class="navbar-inner sliding">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon icon-back"></i>
                        <span class="ios-only">Back</span>
                    </a>
                </div>
                <div class="title">Virtual List without UL/LI</div>
                <!--<div class="subnavbar">-->
                <!--<form data-search-container=".virtual-list" data-search-item="li" data-search-in=".item-title" class="searchbar searchbar-init">-->
                <!--<div class="searchbar-inner">-->
                <!--<div class="searchbar-input-wrap">-->
                <!--<input type="search" placeholder="Search"/>-->
                <!--<i class="searchbar-icon"></i>-->
                <!--<span class="input-clear-button"></span>-->
                <!--</div>-->
                <!--<span class="searchbar-disable-button">Cancel</span>-->
                <!--</div>-->
                <!--</form>-->
                <!--</div>-->
            </div>
        </div>
        <!--<div class="searchbar-backdrop"></div>-->
        <div class="page-content">
            <!--<div class="list simple-list searchbar-not-found">-->
            <!--<ul>-->
            <!--<li>Nothing found</li>-->
            <!--</ul>-->
            <!--</div>-->
            <div class="list virtual-list media-list" style="width:100%">
                <ul class="virtual-list-ul" style="width:100%">
                    <li class="virtual-list-li-table" style="width:100%;display:none">
                        <div style="width:100%;height:24px;border-bottom:solid 1px;" dataItemName="title"></div>
                        <div style="width:100%;height:24px;border-bottom:solid 1px;" dataItemName="subtitle"></div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</template>
<script>
    return {
        data: function() {
            return {
                items: null,
                hotels: null
            };
        },
        on: {
            pageBeforeIn: function(e, page) {                                                               console.log('pageBeforeIn', page);

            },
            pageAfterIn: function(e, page) {
                var self = this;
                var items = [];
                for (var i = 1; i <= 10000; i++){ items.push({ title: 'Item '+i, subtitle: 'Subtitle '+i }); }

                var it= self.$el.find('.virtual-list-li-table')[0].cloneNode(true);                     console.log("1",self.$el.find('.virtual-list-li-table')[0].outerHTML);  //console.log("it",it,it.outerHTML);
                it.style["display"]= "block";                                                                                   console.log("it",it,it.outerHTML); console.dir(it);
                var fillElTText= function(el){
                    if(!el) return;
                    var dataItemName= el.getAttribute("dataItemName");
                    if(!dataItemName) return;
                    el.innerText= "{{"+dataItemName+"}}";
                };
                var fillElsTTextProcess= function(el){
                    if(!el)return;
                    fillElTText(el);
                    for(cel of el.childNodes){
                        if(!cel||cel.nodeType==3/*text*/)continue;
                        fillElsTTextProcess(cel);
                    }
                };
                fillElsTTextProcess(it);

                self.virtualList = app7.virtualList.create({
                    // List Element
                    el: self.$el.find('.virtual-list'),
                    createUl: true,
                    ul: self.$el.find('.virtual-list-ul'),
                    cache: true,
                    // Pass array with items
                    items: items,//items: app.data.items,
                    // Custom search function for searchbar
                    searchAll: function (query, items) {
                        var found = [];
//                        for (var i = 0; i < items.length; i++) {
//                            if (items[i].name.toLowerCase().indexOf(query.toLowerCase()) >= 0 || query.trim() === '') found.push(i);
//                        }
                        return found; //return array with mathced indexes
                    },
                    // List item Template7 template
                    itemTemplate:it.outerHTML,
                    itemTemplate1:
                    '<li style="width:100%">'+
//                    '<div ref-hotel="{{../id}}" class="hotel-card lazy demo-lazy three-images" data-background="{{image}}" style="background:#000;background-size: cover; height: 240px;margin-left:5px;margin-right:5px;margin-top:8px;margin-bottom:8px;border-radius: 5px;">{{name}} / {{star}}</div>'+
                    '<div style="width:100%;height:24px;border-bottom:solid 1px;">{{title}}</div>'+
                    '<div style="width:100%;height:24px;border-bottom:solid 1px;">{{subtitle}}</div>'+
                    '</li>',

//                    '<li>'+
//                    '<div ref-hotel="{{../id}}" class="hotel-card lazy demo-lazy three-images" data-background="{{image}}" style="background:#000;background-size: cover; height: 240px;margin-left:5px;margin-right:5px;margin-top:8px;margin-bottom:8px;border-radius: 5px;">{{name}} / {{star}}</div>'+
//                    '<div style="height: 24px;">{{title}} {{subtitle}}</div>'+
//                    '<tr>'+
//                    '<td>'+
//                    '<div style="height: 24px;">{{title}} {{subtitle}}</div>'+
//                    '</td>'+
//                    '</tr>'+
//                    '</li>',
                    // Item height
                    height: 48
                });
            },

            pageBeforeRemove: function() {
                var self = this;
                self.virtualList.destroy();
            },
            pageInit: function() {
                var self = this;
//                $(document).on("click", ".hotel-card", function(e) {
//                    var _ref_hotel = $(this).attr('ref-hotel');
//                    app.views.main.router.navigate("/hotel-details/" + _ref_hotel + "/", {
//                        reloadCurrent: false,
//                        pushState: false,
//                        context: {}
//                    });
//                });

            }
        }
    }
</script>
